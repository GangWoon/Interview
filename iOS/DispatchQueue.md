# Dispatch Queue

---

작업을 순차적, 동시적으로 실행할 수 있지만 무조건 먼저 들어간 작업은 먼저 실행됨을 보장한다. 

DispatchQueue로 들어가는 작업은 반드시 메소드나 클로저 형태로 제공되어야 한다.

* 스레드 관리를 자동으로 한다.

* 작업중에 예외를 발생시키지 않는다.

* 비동기적으로 작업을 queue에 넣어도 데드락이 발생하지 않는다.

* Race Condition에서도 확장성이 좋다.

* Serial DispatchQueue는 lock이나 여러 동기화 연산보다 더 효율 적이다.



## Serial 

한 번에 하나의 작업만 수행하며, 실행 순서는 Queue에 추가된 순서이다. 실행되는 작업은 별도의 스레드 상에서 실행된다. 주로 특정 자원에 동기적인 접근을 할 때 사용한다. 여러 개의 serial queue를 사용하면, queue 별로 하나의 작업을 수행하게 되면서 전체적으로 보면 동시에 여러 작업을 수행되는 것도 가능하다.



## Concurrent

한 개 이상의 작업을 동시에 실행시킨다. 실행 순서는 큐에 들어온 순서이다. 작업은 별도의 스레드에서 수행된다. 동시에 실행되는 작업의 수는 시스템의 상태에 따라 달라진다.



## Main 

메인 스레드에 연결된 serial queue이다. Application의 메인 RunLoop와 함께 동작하며 다른 Input Source들의 실행 단계 사이에 끼어 들어가 실행하게 된다.



스레드를 만들때 커널 영역과 유저 영억의 메모리를 모두 확보해야하는데, GCD는 그렇지 않는다.





## Qos (Quiality of service)

background 작업들을 시스템이 실행하는 최선의 방법을 결정하기 위한 정보를 제공한다.

* userInteractive: 가장 높은 우선순위, UI 갱신, 애니메이션 처리
* userInitiated: 그 다음 우선순위, 유저가 앱에 기대하는 핵심 정보를 로딩할 때 사용한다.
* default: 앱 초기화 혹은 유저를 대신해 수행하는 작업
* utility: 바로 완료되지 않아도 앱사용에 지장이 없는 부가적인 작업
* background: 앱이 background로 갔을 때 할 작업